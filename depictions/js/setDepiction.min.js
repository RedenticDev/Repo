$(()=>{let o;for(const e of location.search.substring(1).split("&")){var t=e.split("=");"p"==decodeURIComponent(t[0])&&(o=decodeURIComponent(t[1]))}if(o){let a=!0,r="";console.log("Package: "+o);const s=location.href.split("?")[0]+o,d="https://api.github.com/repos/RedenticDev/Repo/commits?path=debs/";$.ajax({type:"GET",url:s+"/info.xml",dataType:"xml"}).done(n=>{console.log("Beginning XML parsing"),$(n).find("packageInfo").each(function(){document.title=$(this).find("name").text().trim();var t=$(this).find("changeVersion:first").text().replace("v","").trim(),[t,e,i]=(compatible($(this).find("miniOS").text().trim(),$(this).find("maxiOS").text().trim()),$(n).find("description").each(function(){$("#description").append("<li>"+$(this).text().trim()+"</li>")}),$(n).find("dependency").each(function(){$("#dependencies").append("<li>"+$(this).text().trim()+"</li>")}),$(n).find("change:first").each(function(){$("#pill").append($(this).find("changeVersion").text().trim()),r+="<li>",$(this).find("changeDescription").each(function(){r+="<h2>- "+$(this).text().trim()+"</h2>"}),r+="</li>"}),lastUpdateDate(d+o+"_"+t+"_iphoneos-arm.deb").then(t=>$("#changelog-date").append(t)).catch(t=>console.error(t)),$("#changelog").append(r+'<table><tr><td><a href="changelog/?p='+o+'" target="_blank">Full changelog</a></td></tr></table>'),$(n).find("screen").each(function(){a=!1,$("#screenshots").append('<li><a href="'+s+"/"+$(this).text().trim()+'" target="_blank"><img src="'+s+"/"+$(this).text().trim()+'" draggable="false" /></a></li>')}),a&&$("#screenshots").append("<li>No screenshots provided.</li>"),$("#infoTable").append("<tr><th>Developer</th><td>"+$(this).find("developer").text().trim()+"</td></tr>"),$("#infoTable").append("<tr><th>Price</th><td>Free</td></tr>"),$("#infoTable").append("<tr><th>Version</th><td>"+t+"</td></tr>"),$("#infoTable").append("<tr><th>iOS Version</th><td>iOS "+$(this).find("miniOS").text().trim()+" to "+$(this).find("maxiOS").text().trim()+"</td></tr>"),$("#infoTable").append('<tr><th>Last update</th></td><td id="last-update"></td></tr>'),$("#infoTable").append('<tr><th>Release date</th></td><td id="release-date"></td></tr>'),lastUpdateDate(d+o+"_"+t+"_iphoneos-arm.deb").then(t=>$("#last-update").append(t)).catch(t=>console.error(t)),lastUpdateDate(d+o+"_"+$(this).find("changeVersion:last").text().replace("v","").trim()+"_iphoneos-arm.deb").then(t=>$("#release-date").append(t)).catch(t=>console.error(t)),$("#infoTable").append("<tr><th>Category</th><td>"+$(this).find("category").text().trim()+"</td></tr>"),$("#links").append('<tr><td><a href="'+$(this).find("github").text().trim()+'" target="_blank"><img src="https://is1-ssl.mzstatic.com/image/thumb/Purple125/v4/a8/34/3c/a8343c15-9a86-ce5f-6218-0b0c41af08f4/AppIcon-0-1x_U007emarketing-0-7-0-85-220.png/217x0w.png" alt="GitHub icon" />GitHub</a></td></tr>'),$("#links").append('<tr><td><a href="'+$(this).find("twitter").text().trim()+'" target="_blank"><img src="https://is1-ssl.mzstatic.com/image/thumb/Purple115/v4/33/eb/b3/33ebb37c-f1f1-8e40-8d88-9dc483fb4a2e/ProductionAppIcon-1x_U007emarketing-0-7-0-0-0-85-220.png/217x0w.png" alt="Twitter icon" />Twitter</a></td></tr>'),$("#links").append('<tr><td><a href="'+$(this).find("reddit").text().trim()+'" target="_blank"><img src="https://is2-ssl.mzstatic.com/image/thumb/Purple115/v4/27/6d/03/276d03c0-7886-4f78-da37-844b679d6c01/AppIcon-1x_U007emarketing-0-7-0-85-220.png/217x0w.png" alt="Reddit icon" />Reddit</a></td></tr>'),$(this).find("discord").text().trim().split("|"));$("#links").append('<tr><td><a href="https://discord.com/users/'+i+'/" target="_blank"><img src="https://is3-ssl.mzstatic.com/image/thumb/Purple125/v4/5e/be/72/5ebe7274-4a54-36e5-a229-854d142dbbfe/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/217x0w.png" alt="Discord icon" />Discord ('+t+"#"+e+")</a></td></tr>"),$("#links").append('<tr><td><a href="'+$(this).find("mail").text().trim()+'" target="_blank"><img src="https://is1-ssl.mzstatic.com/image/thumb/Purple123/v4/c7/40/e5/c740e5f0-2a62-4fa7-dc1b-66ea3d519545/AppIcon-0-1x_U007emarketing-0-0-GLES2_U002c0-512MB-sRGB-0-0-0-85-220-0-0-0-10.png/217x0w.png" alt="Apple Mail icon" />Mail</a></td></tr>'),$("#links").append('<tr><td><a href="'+$(this).find("paypal").text().trim()+'" target="_blank"><img src="https://is5-ssl.mzstatic.com/image/thumb/Purple125/v4/66/37/0d/66370de2-4c2c-43d2-1f2b-dd4b0c5e563a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/217x0w.png" alt="PayPal icon" />Paypal</a></td></tr>')}),console.log("XML parsing done.")}).fail(()=>{var t='Package "'+o+'" not found. Incorrect parameter or no depiction for this package.';$("#compatibility").append("Unknown"),$("#description").append("<li>"+t+"</li>"),$("#pill").append("v?"),$("#changelog-date").append("../../...."),$("#changelog").append("Unavailable"),$("#dependencies").append("Error"),$("#screenshots").append("No screenshot"),$("#infoTable").append("No info"),$("#links").append("Unavailable")})}else console.log("Package not found. Aborting.")}),$("img").bind("dragstart",()=>!1),$("img").bind("mousedown",()=>!1);let updateDatesDict={};function lastUpdateDate(o){function t(n){return new Promise((t,e)=>{const i=new XMLHttpRequest;i.onload=()=>{200==i.status&&4==i.readyState&&t(i.response),e(i.status)},i.onerror=()=>e(i.status),i.open("GET",n),i.send()})}return new Promise((r,e)=>{if(o in updateDatesDict)console.log("Using cached value for url "+o+" ("+updateDatesDict[o]+")"),r(updateDatesDict[o]);else{let a=0;const i=()=>{t(o).then(n=>{t(String(o).replace("mmits?path=","ntents/").concat("?ref=",JSON.parse(n)[a].sha)).then(t=>{const e=new Date(JSON.parse(n)[a].commit.author.date);console.log("Date successfully fetched for url: "+o+" ("+e+")");var i=e.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"});updateDatesDict[o]=i,r(i)}).catch(t=>{a++,console.warn("Retrying call with commit "+a+" for url "+o),i()})}).catch(t=>{e("Error getting sha value ("+t+")")})};i()}})}function compatible(t,e){var i,n=parseFloat((""+(/CPU.*OS ([0-9_]+)|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""));t=numerize(t),e=numerize(e);const a=document.getElementById("compatibility"),r=document.getElementById("compatibility-box");n<t?(a.innerHTML="Your iOS version is too old for this package. It is compatible from iOS "+t+" to "+e+".",a.style.color="red",r.style.backgroundColor="lightpink",r.style.border="1px solid red"):e<n?(t="This package has not been tested yet with your version of iOS",i="The latest update officially supports up to iOS "+e+".",~~n==~~e?(a.innerHTML=t+", but may work fine. "+i,a.style.color="goldenrod",r.style.backgroundColor="lightyellow",r.style.border="1px solid goldenrod"):(a.innerHTML=t+", and might not work properly. "+i,a.style.color="lightgoldenrodyellow",r.style.backgroundColor="darkgoldenrod",r.style.border="1px solid orange")):isNaN(n)?(a.innerHTML="Cannot determine your version. Open this page on an iOS device to check compatibility.",a.style.fontStyle="italic"):(a.innerHTML="This package works on your device!",a.style.color="green",r.style.backgroundColor="lightgreen",r.style.border="1px solid green")}function numerize(t){return t.substring(0,t.indexOf("."))+"."+t.substring(t.indexOf(".")+1).replace(".","")}